<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wealth Tax World Map</title>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      height: 100vh;
      display: flex;
      background: linear-gradient(135deg, #062f1f, #0b3d2e);
      color: #e6fff2;
    }

    .layout {
      display: grid;
      grid-template-columns: 2fr 1fr;
      width: 100%;
      height: 100%;
    }

    #map {
      width: 100%;
      height: 100%;
    }

    .sidebar {
      padding: 1.5rem;
      background: radial-gradient(circle at top left, #0f3f2f, #041f17);
      border-left: 1px solid rgba(46, 204, 113, 0.4);
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .sidebar h1 {
      font-size: 1.4rem;
      font-weight: 600;
      color: white;
    }

    .card {
      background: rgba(0, 50, 35, 0.85);
      border-radius: 1rem;
      padding: 1rem;
      border: 1px solid rgba(46, 204, 113, 0.3);
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
      flex: 1;
      overflow-y: auto;
    }

    .card-section-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #86efac;
      margin-top: 1rem;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin: 0.5rem 0;
    }

    .pill {
      font-size: 0.7rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(46, 204, 113, 0.4);
      text-transform: uppercase;
    }

    .pill.net { background:#2ecc71; color:#062f1f; }
    .pill.alt { background:#84cc16; color:#062f1f; }
    .pill.none { background:#14532d; color:#e6fff2; }

    .legend {
      font-size: 0.8rem;
      margin-top: 0.5rem;
      display: flex;
      gap: 1rem;
    }

    .legend span {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .swatch {
      width: 14px;
      height: 14px;
      border-radius: 50%;
    }

    .net-swatch { background:#2ecc71; }
    .alt-swatch { background:#84cc16; }
    .none-swatch { background:#14532d; }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: 1fr;
        grid-template-rows: 1.3fr 1.2fr;
      }
    }
  </style>
</head>
<body>

<div class="layout">
  <div id="map"></div>

  <aside class="sidebar">
    <h1>Global Wealth Taxes Explorer</h1>

    <div class="legend">
      <span><div class="swatch net-swatch"></div> Net wealth tax</span>
      <span><div class="swatch alt-swatch"></div> Asset-based</span>
      <span><div class="swatch none-swatch"></div> No net wealth tax</span>
    </div>

    <div id="info-card" class="card">
      <h2 id="country-name">United Kingdom</h2>

      <div id="status-pills" class="pill-row"></div>

      <div class="card-section-title">Summary</div>
      <p id="summary-text">
        The UK does not have a broad annual net wealth tax.
      </p>

      <div class="card-section-title">Design</div>
      <p id="design-text">–</p>

      <div class="card-section-title">Alternatives</div>
      <p id="alternatives-text">–</p>
    </div>
  </aside>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ========= COUNTRY DATA ========= */

const wealthTaxByCountry = {
  "United Kingdom": {
    status: "none",
    summary: "The UK does not have an annual net wealth tax.",
    design: "Wealth is taxed through property tax, capital gains tax, and inheritance tax.",
    alternatives: "Council Tax, CGT, Inheritance Tax."
  },
  Switzerland: {
    status: "net",
    summary: "Thresholds vary by canton. Net wealth tax on worldwide assets.",
    design: "Progressive rates typically 0.1%–1%.",
    alternatives: "Relatively low capital gains taxes."
  },
  Norway: {
    status: "net",
    summary: "~1.7 million NOK (around £120–130k).Married couples double threshold",
    design: "1-1.1 total%. Divided between municipal and state portions",
    alternatives: "Inheritance tax: abolished in 2014. Capital gains tax: 37.8% effective rate (on shares, etc.) Property tax: local and limited."
  },
  Spain: {
    status: "net",
    summary: "Progressive net wealth tax above €700k. Applies to all wealth for residents and wealth located in Spain for non-residents",
    design: "Rates vary by region 0.2% - 3.5%.",
    alternatives: "Inheritance, capital gains taxes and municipial property tax. Temporary “Solidarity Wealth Tax” on ultra-wealthy (assets over €3 million) ."
  },
  France: {
    status: "alt",
    summary: "Replaced wealth tax with real-estate wealth tax (IFI).",
    design: "Applies to real estate assets worth over €1.3 million. Was previously on net wealth on worldwide assets.",
    alternatives: "Inheritance and capital gains taxes."
  },
  Sweden: {
    status: "net",
    summary: "Abolished in 2007. Before Abolition: threshold of 1.5 million SEK",
    design: "Flat 1.5% annual rate.",
    Reason for ending: "Capital flight and administrative costs exceeded revenue benefits"
  },
  Netherlands: {
    status: "net",
    summary: "Calculates income from assets, pay 36% wealth tax on total returns. ",
    Design "Effectively 1-1.3% wealth-equivalent tax"
};
  

/* ========= MAP SETUP ========= */

const map = L.map("map", {
  zoomControl: true,
  minZoom: 1.3
}).setView([20, 0], 2);

L.tileLayer(
  "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
  { maxZoom: 19 }
).addTo(map);

let geojsonLayer;

function getColor(status) {
  if (status === "net") return "#2ecc71";
  if (status === "alt") return "#84cc16";
  return "#14532d";
}

function style(feature) {
  const country = wealthTaxByCountry[feature.properties.name];
  const status = country ? country.status : "none";

  return {
    fillColor: getColor(status),
    weight: 0.7,
    color: "#064e3b",
    fillOpacity: 0.75
  };
}

function highlightFeature(e) {
  e.target.setStyle({
    weight: 2,
    color: "#ffffff",
    fillOpacity: 0.9
  });
}

function resetHighlight(e) {
  geojsonLayer.resetStyle(e.target);
}

function updatePanel(name) {
  const data = wealthTaxByCountry[name];

  document.getElementById("country-name").textContent = name;
  const pills = document.getElementById("status-pills");
  pills.innerHTML = "";

  if (!data) {
    pills.innerHTML = `<span class="pill none">No data</span>`;
    document.getElementById("summary-text").textContent = "No information added yet.";
    document.getElementById("design-text").textContent = "–";
    document.getElementById("alternatives-text").textContent = "–";
    return;
  }

  pills.innerHTML = `<span class="pill ${data.status}">${data.status.toUpperCase()}</span>`;
  document.getElementById("summary-text").textContent = data.summary;
  document.getElementById("design-text").textContent = data.design;
  document.getElementById("alternatives-text").textContent = data.alternatives;
}

function onEachFeature(feature, layer) {
  layer.on({
    mouseover: highlightFeature,
    mouseout: resetHighlight,
    click: () => updatePanel(feature.properties.name)
  });
}

fetch("https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json")
  .then(res => res.json())
  .then(data => {
    geojsonLayer = L.geoJSON(data, {
      style,
      onEachFeature
    }).addTo(map);
  });

updatePanel("United Kingdom");

</script>
</body>
</html>
